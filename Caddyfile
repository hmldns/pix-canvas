{$DOMAIN} {
    # Serve static frontend files
    handle_path /* {
        reverse_proxy frontend:3000
    }

    # WebSocket connection to backend  
    handle /ws* {
        reverse_proxy backend:3001
    }

    # REST API endpoints
    handle /api/* {
        reverse_proxy backend:3001
    }

    # WebRTC signaling service (Socket.IO)
    handle /ws/socket.io/* {
        reverse_proxy signaling:3002
    }

    # Enable logging for debugging
    log {
        output stdout
        format json
    }
}
